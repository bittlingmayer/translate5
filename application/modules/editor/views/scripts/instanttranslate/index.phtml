<?php
/*
 START LICENSE AND COPYRIGHT
 
 This file is part of translate5
 
 Copyright (c) 2013 - 2017 Marc Mittag; MittagQI - Quality Informatics;  All rights reserved.
 
 Contact:  http://www.MittagQI.com/  /  service (ATT) MittagQI.com
 
 This file may be used under the terms of the GNU AFFERO GENERAL PUBLIC LICENSE version 3
 as published by the Free Software Foundation and appearing in the file agpl3-license.txt
 included in the packaging of this file.  Please review the following information
 to ensure the GNU AFFERO GENERAL PUBLIC LICENSE version 3 requirements will be met:
 http://www.gnu.org/licenses/agpl.html
 
 There is a plugin exception available for use with this release of translate5 for
 translate5: Please see http://www.translate5.net/plugin-exception.txt or
 plugin-exception.txt in the root folder of translate5.
 
 @copyright  Marc Mittag, MittagQI - Quality Informatics
 @author     MittagQI - Quality Informatics
 @license    GNU AFFERO GENERAL PUBLIC LICENSE version 3 with plugin-execption
 http://www.gnu.org/licenses/agpl.html http://www.translate5.net/plugin-exception.txt
 
 END LICENSE AND COPYRIGHT
 */
?>

<?php
    // Which languages are available according to the MachinteTranslation-Engines?
    $machineTranslationEngines = $this->machineTranslationEngines;
    $mtSourceLanguageLocales = array();
    $mtTargetLanguagesLocales = array();
    foreach ($machineTranslationEngines as $mtEngine) {
        $mtSourceLocale = $mtEngine['source'];
        $mtTargetLocale = $mtEngine['target'];
        if (!in_array($mtSourceLocale, $mtSourceLanguageLocales)) {
            $mtSourceLanguageLocales[] = $mtSourceLocale;
        }
        if (!in_array($mtTargetLocale, $mtTargetLanguagesLocales)) {
            $mtTargetLanguagesLocales[] = $mtTargetLocale;
        }
    }
?>

<div id="containerHeader" class="container">
    <div id="logo"></div>
<?php 
    // see View_Helper_LanguageSelector
    $session = new Zend_Session_Namespace();
    $translate = ZfExtended_Zendoverwrites_Translate::getInstance();
    $availableTranslations = $translate->getAvailableTranslations();
    asort($availableTranslations);
    echo '<form action="#" method="post" name="languageSelector" id="languageSelector">';
    echo '<select id="locale">';
    foreach ($availableTranslations as $locale => $translation) {
        $selected = ($locale == $session->locale) ? ' selected' : '';
        echo '<option value="'.$locale.'"'.$selected.'>'.$translation.'</option>';
    }
    echo '</select>';
    echo '</form>';
?>
    <div id="logout"><a href="/login/logout" class="ui-button ui-widget ui-corner-all">Logout</a></div>
</div>


<div id="containerSelect" class="container">
  <fieldset>
    <legend><?php echo $this->translations["availableMTEngines"];?>:</legend>
    <?php 
    foreach ($machineTranslationEngines as $mtEngineId => $mtEngine) {
        echo '<label for="'.$mtEngineId.'">'.$mtEngine['name'].'</label>';
        echo '<input type="radio" name="mtEngines" id="'.$mtEngineId.'">';
        }
    ?>
  </fieldset>
</div>

<div id="containerContent" class="container">
	<div id="source">
        <form id="sourceLanguageSelector" name="sourceLanguageSelector">
            <select id="sourceLocale" name="sourceLocale">
                <option value="-">-</option>
                <?php 
                    foreach ($mtSourceLanguageLocales as $sourceLangLocale) {
                        $selected = ($sourceLangLocale== $this->sourceSearchLanguagePreselectionLocale) ? ' selected' : '';
                        echo '<option value="'.$sourceLangLocale.'"'.$selected.'>'.$sourceLangLocale.'</option>';
                    }
                ?>
            </select>
            <span class="clearable">
                <textarea id="sourceText" name="sourceText" wrap="SOFT"></textarea> <!-- TODO: what to do with a lot of text (and after clearing)? Scrollbars? Resize?-->
                <span class="clearable-clear">&times;</span> <!-- TODO: (1) reposition after resizing the textarea by the user (2) interferes with scrollbars-->
                <span id="countedCharacters">0</span>
            </span>
        </form>
    </div>
    <div id="translations">
        <form id="translationControls" name="translationControls">
            <select id="translationLocale" name="translationLocale">
                <option value="-">-</option>
                <?php 
                    foreach ($mtTargetLanguagesLocales as $targetLangLocale) {
                        $selected = ($targetLangLocale== $this->targetSearchLanguagePreselectionLocale) ? ' selected' : '';
                        echo '<option value="'.$targetLangLocale.'"'.$selected.'>'.$targetLangLocale.'</option>';
                    }
                ?>
            </select>
            <input id="translationSubmit" name="translationSubmit" value="<?php echo $this->translations["translate"];?>" type="submit" class="ui-corner-all ui-button ui-widget filled-color">
            <span id="instantTranslationIsOff" class="instant-translation-toggle"><a href="#"><?php echo $this->translations["turnOnInstantTranslation"];?></a></span>
            <span id="instantTranslationIsOn" class="instant-translation-toggle"><a href="#"><?php echo $this->translations["turnOffInstantTranslation"];?></a></span>
        </form>
        <div class="copyable">
            <div class="translation-result">translation 1....</div>
            <span class="copyable-copy"><span class="ui-icon ui-icon-copy"></span></span>
        </div>
        <div class="copyable">
            <div class="translation-result">translation 2....</div>
            <span class="copyable-copy"><span class="ui-icon ui-icon-copy"></span></span>
        </div>
        <div class="copyable">
            <div class="translation-result">translation 3....</div>
            <span class="copyable-copy"><span class="ui-icon ui-icon-copy"></span></span>
        </div>
    </div>
</div>

<script type="text/javascript">
    //for later usage
</script>

<script type="text/javascript">
$( function() {
    $('#locale').selectmenu({
        change: function() {
            var action = $(this).val();
            $("#languageSelector").attr("action", "?locale=" + action);
            $("#languageSelector").submit();
        }
      });
    $("input[type='radio']").checkboxradio();
    $('#sourceLocale').selectmenu();
    $('#translationLocale').selectmenu();
    $('#translationSubmit').button();
} );
</script>

<script src="<?php echo APPLICATION_RUNDIR; ?>/modules/editor/instanttranslate/js/Instanttranslate.js"></script>
